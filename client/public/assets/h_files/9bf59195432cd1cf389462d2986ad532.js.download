"undefined"==typeof $mo&&($mo=jQuery),activeTimers=[];let flag=1,isAjaxButtonInitialized=!1;var isformFound=!1,isPopUpLoaded=!1;const buttonSelectors=['input[id*="mo_wc_send_otp"]','input[id*="miniorange_otp_token_submit"]','input[id*="mo_send_otp_"]','input[id*="mo_otp_token_submit"]','input[id*="mo_tutor_lms_login_send_otp"]','input[id*="mo_um_send_otp_pass"]','input[id*="mo_um_accup_button"]','input[id*="mo_tutor_lms_send_otp"]','input[id*="mo_tutor_lms_student_send_otp"]','input[id*="mo_um_getotp_button"]','input[id*="send_otp"]','a[id*="miniorange_otp_token_submit"]','button[id*="miniorange_otp_token_submit"]','button[id*="mo_send_otp_"]','input[id*="mo_um_accup_button"]',];function waitForAnyElement(t,e){let i=setInterval(()=>{let o=t.find(t=>$mo(t).length>0);o&&(clearInterval(i),e(o))},100);setTimeout(()=>{clearInterval(i)},3e3)}function checkUserBlocked(){return new Promise((t,e)=>{$mo.ajax({url:moOtpTimerScript.siteURL,type:"POST",data:{action:"check_blocked"},success:function(e){e.blocked?t({isBlocked:!0,remaining_time:e.remaining_time}):t({isBlocked:!1,remaining_time:null})},error:function(){e({isBlocked:!1,remaining_time:null})}})})}function ajaxButtonClicked(){let t='div[id*="mo_message"]',e=moOtpTimerScript.limit_otp_sent_message;buttonSelectors.forEach(function(i){$mo(i).each(function(){let o=$mo(this);$mo(i).length>0&&flag&&(flag=0,o.on("click",function(){$mo(i).hide();let n=setInterval(function(){if(0===$mo.active){clearInterval(n);let r=$mo(t),l=r.attr("style"),c=r.attr("class");var a=l.includes("red")||l.includes("#ffefef")||l.includes("background-color: rgb(255, 239, 239)")||l.includes("background-color: rgb(237, 165, 142)");if(void 0!==c)var a=c.includes("woocommerce-error");a?($mo(i).show(),clearAllIntervals()):(r.empty().append("<div class='moloader'></div>"),checkUserBlocked().then(function(i){let n=i.isBlocked?i.remaining_time:moOtpTimerScript.otpControlTimerTime,r=moOtpTimerScript.user_blocked_message;var l=i.isBlocked?r:e;clearAllIntervals(),buttonTimer(n,o,document.querySelector(t),l,i.isBlocked)}).catch(function(t){}))}},10)}))})})}function unblockUser(){return $mo.ajax({url:moOtpTimerScript.siteURL,type:"POST",data:{action:"unblock_user"}})}function buttonTimer(t,e,i,o,n){i&&$mo(i).show(),startTimer(t,i,e,o,n)}function startTimer(t,e,i,o,n){let r=t;window.sentTimerFunction=setInterval(()=>{let t=String(Math.floor(r/60)).padStart(2,"0"),n=String(r%60).padStart(2,"0"),l=o.replace("{minutes}",t).replace("{seconds}",n);if(window.verifyOTPmessage&&e){var c=moOtpTimerScript.error_otp_verify_message.replace("{minutes}",t).replace("{seconds}",n);e.innerHTML=window.verifyOTPmessage+"<br>"+c}else e&&(e.textContent=l);r<=1&&unblockUser().fail(t=>{}),r<=0&&(clearInterval(sentTimerFunction),window.verifyOTPmessage&&delete window.verifyOTPmessage,$mo(e).hide(),$mo(i).show(),$mo(i).attr("data-timer-active","false")),r--},1e3),activeTimers.push(sentTimerFunction)}function clearAllIntervals(){activeTimers.forEach(function(t){clearInterval(t)}),activeTimers=[]}function mo_pop_up_limit_otp(){isPopUpLoaded=!0;let t=$mo("a[id*='mo_otp_verification_resend']"),e="a[id*='mo_otp_verification_resend']";$mo("<p id='otpTimer' hidden style='float:right;margin-top:5px'></p>").insertAfter(t),['a[id*="mo_otp_verification_resend"]','button[id*="miniorange_wc_popup_send_otp_token"]','a[id*="miniorange_wc_popup_send_otp_token"]','input[id*="miniorange_wc_popup_send_otp_token"]',].forEach(function(i){'input[id*="miniorange_wc_popup_send_otp_token"]'===i||'a[id*="miniorange_wc_popup_send_otp_token"]'===i?$mo(document).on("click",i,function(){$mo(document).off("ajaxComplete").on("ajaxComplete",function(i,o,n){if(n.url.includes("?option=miniorange-woocommerce-checkout"))try{let r=JSON.parse(o.responseText);200===o.status&&"success"===r.result&&($mo(e).hide(),popupButtonClick(e,t))}catch(l){console.error("Error parsing AJAX response:",l)}})}):$mo(document).on("click",i,function(){$mo(e).hide(),waitForOTPCall(()=>{popupButtonClick(e,t)})})})}function popupButtonClick(t,e){checkUserBlocked().then(function(i){let o=i.isBlocked?i.remaining_time:moOtpTimerScript.otpControlTimerTime;e.length>0?PopUpbuttonTimer(t,o):$mo(t).show()})}function PopUpbuttonTimer(t,e){$mo(display=document.querySelector("#otpTimer")).show(),PopUpstartTimer(e,display,t)}function PopUpstartTimer(t,e,i){var o,n,r=t,l=setInterval(function(){o=parseInt(r/60,10),n=parseInt(r%60,10),o=o<10?"0"+o:o,n=n<10?"0"+n:n,e.textContent=o+":"+n+" minutes.",r<1&&($mo(e).hide(),$mo(i).show(),unblockUser().fail(t=>{}),clearInterval(l)),--r<0&&(r=t)},1e3);activeTimers.push(l)}function waitForOTPCall(t){let e=setInterval(()=>{void 0!==window.mo_wc_otp_initialized&&(window.mo_wc_otp_initialized&&t(),delete window.mo_wc_otp_initialized,clearInterval(e))},100);setTimeout(()=>{clearInterval(e)},2e4)}$mo(document).ready(function(){setTimeout(function(){if(!$mo("#mo-time-remain").length>0&&!$mo("#mo_site_otp_form").length>0){let t="undefined"!=typeof mo_ninja_field?mo_ninja_field:null,e="undefined"!=typeof mowc_otp_type?mowc_otp_type:null,i=!1,o=!1;Object.entries({".ninja-forms-field":t,".woocommerce-EditAccountForm":"phone"===e?'input[id="billing_phone"]':'input[id="account_email"]',".um-account-tab":'input[id="user_email"]',".um-profile-body":'input[id*="mobile_number"]'}).forEach(([t,e])=>{$mo(t).length>0&&!isAjaxButtonInitialized&&(o=!0,$mo(e).on("keyup input",function(t){isAjaxButtonInitialized||(isAjaxButtonInitialized=!0,waitForAnyElement(buttonSelectors,()=>{ajaxButtonClicked()}))}))}),o||(i?ajaxButtonClicked():(waitForAnyElement(buttonSelectors,()=>{ajaxButtonClicked()}),i=!0))}else clearAllIntervals();$mo("#mo_site_otp_form").length>0&&!isPopUpLoaded&&($mo("#send_otp").length>0?($mo("#validate_otp").on("click",function(){clearAllIntervals()}),ajaxButtonClicked()):mo_pop_up_limit_otp())},100)})
;